{"ast":null,"code":"var _jsxFileName = \"/Users/pokeoseu/Desktop/React-Self-Study/YouTube-self/self/src/Main.js\";\nimport React from 'react';\nimport './App.css';\nimport axios from 'axios';\nimport Nav from './component/Nav/Nav';\nimport SearchBar from './component/SearchBar/SearchBar';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport uuid from 'uuid';\nimport { spinner } from './component/images/';\nimport VideoList from './component/VideoList/VideoList';\nimport qs from 'qs';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { updateQuery } from './actions';\n\nclass Main extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      videos: [],\n      // query: this.props.query,\n      selectedVideos: null,\n      nextPageToken: null\n    };\n    Object.getOwnPropertyNames(Main.prototype).forEach(key => this[key] = this[key].bind(this));\n    this.defaultState = this.state;\n  }\n\n  async getYoutubeData(query) {\n    if (!query) {\n      this.setState(this.defaultState);\n      setTimeout(() => {\n        this.props.history.push(`/results?search_query=${query}`);\n      }, 0);\n      return;\n    }\n\n    if (this.state.query !== query) {\n      this.setState(this.defaultState);\n      setTimeout(() => {\n        this.props.history.push(`/results?search_query=${query}`);\n      }, 0);\n    }\n\n    const nextPageToken = this.state.nextPageToken;\n    const params = {\n      key: process.env.REACT_APP_YOUTUBE_API_KEY,\n      q: query,\n      part: 'snippet',\n      maxResults: 10,\n      pageToken: nextPageToken\n    };\n\n    const _ref = await axios.get(`https://www.googleapis.com/youtube/v3/search`, {\n      params\n    }),\n          data = _ref.data;\n\n    this.setState({\n      videos: [...this.state.videos, ...data.items],\n      // query,\n      nextPageToken: data.nextPageToken\n    });\n    this.props.updateQuery(query);\n  }\n\n  componentDidMount() {\n    const props = this.props;\n\n    if (props.location) {\n      const _qs$parse = qs.parse(props.location.search),\n            search_query = _qs$parse.search_query;\n\n      if (search_query) this.getYoutubeData(search_query || '');\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const props = this.props;\n\n    if (props.location) {\n      const _qs$parse2 = qs.parse(props.location.serach),\n            search_query = _qs$parse2.search_query;\n\n      const _qs$parse3 = qs.parse(prevProps.location.search),\n            prev = _qs$parse3.search_query;\n\n      if (search_query !== prev) this.getYoutubeData(search_query || '');\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, React.createElement(Nav, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, React.createElement(SearchBar, {\n      onSearchVideos: e => this.history.push(`results?search_query=${e}`),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    })), React.createElement(InfiniteScroll // loadMore={() => this.getYoutubeData(this.props.query)}\n    , {\n      hasMore: !!this.state.nextPageToken && !this.state.selectedVideos,\n      loader: React.createElement(\"div\", {\n        key: uuid.v4(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: spinner,\n        alt: \"loading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      })),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(VideoList, Object.assign({}, this.state, {\n      onVideoSelect: selectedVideos => this.props.history.push(`/watch?v=${selectedVideos}`),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    query: state.videos.query\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators({\n    updateQuery\n  }, dispatch);\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Main));","map":{"version":3,"sources":["/Users/pokeoseu/Desktop/React-Self-Study/YouTube-self/self/src/Main.js"],"names":["React","axios","Nav","SearchBar","InfiniteScroll","uuid","spinner","VideoList","qs","withRouter","connect","bindActionCreators","updateQuery","Main","Component","constructor","props","state","videos","selectedVideos","nextPageToken","Object","getOwnPropertyNames","prototype","forEach","key","bind","defaultState","getYoutubeData","query","setState","setTimeout","history","push","params","process","env","REACT_APP_YOUTUBE_API_KEY","q","part","maxResults","pageToken","get","data","items","componentDidMount","location","parse","search","search_query","componentDidUpdate","prevProps","prevState","serach","prev","render","e","v4","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\nimport axios from 'axios';\nimport Nav from './component/Nav/Nav';\nimport SearchBar from './component/SearchBar/SearchBar';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport uuid from 'uuid';\nimport {spinner} from './component/images/'\nimport VideoList from './component/VideoList/VideoList';\nimport qs from 'qs';\nimport {withRouter} from 'react-router-dom';\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {updateQuery} from './actions';\n\nclass Main extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      videos: [],\n      // query: this.props.query,\n      selectedVideos: null,\n      nextPageToken: null\n    }\n    Object.getOwnPropertyNames(Main.prototype).forEach(key => this[key] = this[key].bind(this));\n    this.defaultState = this.state;\n  }\n  async getYoutubeData(query) {\n    if (!query) {\n      this.setState(this.defaultState);\n        setTimeout(()=>{\n          this.props.history.push(`/results?search_query=${query}`)\n        },0)\n      return;\n    }\n    if (this.state.query !== query) {\n      this.setState(this.defaultState);\n      setTimeout(()=>{\n        this.props.history.push(`/results?search_query=${query}`)\n      },0);\n    }\n    const { nextPageToken } = this.state;\n\n    const params = {\n      key: process.env.REACT_APP_YOUTUBE_API_KEY,\n      q: query,\n      part: 'snippet',\n      maxResults:10,\n      pageToken: nextPageToken\n    }\n    const { data } = await axios.get(`https://www.googleapis.com/youtube/v3/search`, { params });\n    this.setState({\n      videos: [ ...this.state.videos, ...data.items ],\n      // query,\n      nextPageToken: data.nextPageToken\n    });\n    this.props.updateQuery(query);\n  }\n   componentDidMount() {\n    const {props}=this;\n    if(props.location){\n      const {search_query}=qs.parse(props.location.search);\n      if(search_query)this.getYoutubeData( search_query || '' );\n\n    }\n  }\n  componentDidUpdate(prevProps,prevState,){\n    const {props}=this;\n    if(props.location){\n      const {search_query}=qs.parse(props.location.serach);\n      const {search_query:prev} =qs.parse(prevProps.location.search);\n      if(search_query !== prev) this.getYoutubeData(search_query || '');\n    }\n\n  }\n  render() {\n    return (\n      <div>\n        <Nav>\n          <SearchBar onSearchVideos={e=>this.history.push(`results?search_query=${e}`)} />\n        </Nav>\n\n        <InfiniteScroll\n          // loadMore={() => this.getYoutubeData(this.props.query)}\n          hasMore={!!this.state.nextPageToken && !this.state.selectedVideos}\n          loader={\n            <div key={uuid.v4()} >\n              <img src={spinner} alt=\"loading\"/>\n            </div>\n          }\n            >\n              <VideoList\n                {...this.state} onVideoSelect={selectedVideos=>this.props.history.push(`/watch?v=${selectedVideos}`)}\n              />\n        </InfiniteScroll>\n      </div>\n    );\n  }\n}\nfunction mapStateToProps(state){\n  return {\n    query:state.videos.query\n  }\n}\nfunction mapDispatchToProps(dispatch){\n  return bindActionCreators({updateQuery},dispatch)\n}\nexport default withRouter(connect(mapStateToProps,mapDispatchToProps)(Main));\n"]},"metadata":{},"sourceType":"module"}